<!DOCTYPE html>
<html lang="en">
<head>
<title>Quick Clinic</title>
<meta name="description" content="MFC is Best Hospital in Abu Dhabi providing state-of-the-art, quality, & integrated healthcare for all, in conformance to service delivery standards.">
<meta name="keywords" content="MFC Hospital Gujat, Best Hospital in Abu Dhabi, Best Hospital in UAE, Top Hospital in Abu Dhabi, Top Hospital in UAE">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="canonical" href="my-profile-settings.html">
<link type="image/x-icon" href="front/images/IMC_icon.png" rel="icon">
  <!-- Bootstrap CSS -->
<link rel="stylesheet" href="patient/assets/css/bootstrap.min.css">
  <!-- Fontawesome CSS -->
<link rel="stylesheet" href="patient/assets/plugins/fontawesome/css/all.min.css">
  <!-- Main CSS -->
<link rel="stylesheet" href="patient/assets/css/style.css">
<style>
	.card-color {
		background-color: #fff200;
		padding: 6px;
		border-radius: 10px
	}
	.button-color {
		background-color: #fff200;
	}
	a {
        color: #2E3842;
    }

    .err-text {
        color: red;
    }

    .success-text {
        color: green;
    }
</style>     
<!-- Css Files-->
<link rel="stylesheet" href="front/css/style.css">
<link href="front/css/aos.css" rel="stylesheet">
<link href="front/css/font-awesome.min.css" rel="stylesheet">
<link href="front/css/owl.carousel.min.css" rel="stylesheet">
<link rel="stylesheet" href="front/css/responsive.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.0/css/bootstrap.min.css" />
</head>
<body>
<div class="main-wrapper">
    <header class="header the-header">
        <nav class="navbar navbar-expand-lg header-nav">
        <a href="index.html" class="navbar-brand logo" width="160" height="57">
            <img src="patient/assets/img/logo.svg" width="220px" height="73px" alt="logo">
        </a>
        <div class="button-appointment"> <a href="index.html"> <small>Visit Website</small> <span><img class="btn-margin" src="front/images/arrow.png" width="15px" height="11px" alt="arrow"></span> </a> </div>
        <ul class="nav header-navbar-rht ">
            <li class="nav-item dropdown has-arrow logged-item">
                <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                    <span class="user-img" >
                        <img class="rounded-circle" id="user-img" src="storage/assets/images/patient/dummy.jpg" width="31" alt="" >
                    </span>
                </a>
                <div class="dropdown-menu dropdown-menu-right">
                    <div class="user-header">
                        <div class="avatar avatar-sm">
                            <img id="user-img2" alt="" class="avatar-img rounded-circle">
                        </div>
                        <div class="user-text">
                            <h6>hammad </h6>
                        </div>
                    </div>
                    <a class="dropdown-item" href="my-profile-settings.html">Edit Profile</a>
                    <a class="dropdown-item" href="patient-change-password.html">Change Password</a>
                    <a class="dropdown-item" onclick="logout()" >Logout</a>
                </div>
            </li>
        </ul>
    </nav>
</header>
<!-- /Header -->

    <div class="content">

        <div class="container-fluid">



            <div class="row">


 <!-- Profile Sidebar -->

 <div class="col-md-3  col-sm-4 theiaStickySidebar">
    <div
        style="border-top: 6px solid; border-bottom: 6px solid; border-color: #0d6a8d; margin-top: 0px; border-radius: 10px; margin-bottom:5px;">


        <div class="profile-sidebar" style="margin-top: 4px; margin-bottom: 4px; border-radius: 7px;">

            <div class="widget-profile pro-widget-content card-color" style="border-radius: 5px;">

                <div class="profile-info-widget">

                    <a href="/my-dashboard.html" class="booking-doc-img"
                        style="background-color: #818285; ">


                       


                    </a>
                    <br>
                    <div class="profile-det-info" >

                        <h3 id="profile-info-name"></h3>

                    </div>



                </div>

            </div>

            <div class="dashboard-widget">

                <nav class="dashboard-menu">

                    <ul>

                        <li class="">

                            <a href="/my-dashboard.html">

                                <i class="fas fa-columns"></i>

                                <span>Dashboard</span>

                            </a>

                        </li>

                        <li class="">

                            <a href="/my-appointment.html">

                                <i class="fas fa-calendar-check"></i>

                                <span>My Appointments</span>

                            </a>

                        </li>


                        <li class="">

                            <a href="/my-profile-settings.html">

                                <i class="fa fa-pencil" aria-hidden="true"></i>

                                <span>Edit Profile</span>

                            </a>

                        </li>

                        <li class="">



                            <a href="/patient-change-password.html">

                                <i class="fa fa-lock" aria-hidden="true"></i>

                                <span>Change Password</span>

                            </a>

                        </li>

                        <li>

                            <a onclick="logout()">

                                <i class="fa fa-sign-out" aria-hidden="true"></i>

                                <span>Logout</span>

                            </a>

                        </li>


                    </ul>

                </nav>

            </div>



        </div>
    </div>
</div>
<!-- / Profile Sidebar -->

                <div class="col-md-9 col-sm-8 col-lg-8 col-xl-9">

                    <div class="card table-responsive">

                        <div class="card-body">
                            
                            


                            <!-- Profile Settings Form -->

                            <form   id="user-form">


                                <div class="row form-row">

                                    <div class="col-12 col-md-12">

                                        <div class="form-group">

                                            <!-- <div class="change-avatar">

                                              <h5 id="img-name"></h5>

                                                <div class="upload-img" >

                                                    <div class="change-photo-btn button-color">

                                                        <span><i class="fa fa-upload"></i> Upload Photo</span>

                                                        <input id="upload-img" type="file" name='photo' class="upload">

                                                    </div>

                                                    <small class="form-text text-muted">Allowed JPG, GIF or PNG. Max

                                                        size of 2MB</small>

                                                        <button onclick="uploadImage()"  type="submit">Submit image</button>

                                                </div>

                                            </div> -->

                                        </div>

                                    </div>


                                    </div>

                                    <div class="col-12 col-md-4">

                                        <div class="form-group">

                                            <label>Email ID</label>

                                            <input id="emailinput" type="email" name="email" class="form-control" value=''>

                                        </div>

                                    </div>

                                    <div class="col-12 col-md-4">

                                        <div class="form-group">

                                            <label>Phone no</label>

                                            <input id="phonenoinput" type="text" name="phone_no" class="form-control" value=''>

                                        </div>

                                    </div>



                                    <div class="col-12 col-md-4">

                                        <div class="form-group">

                                            <label>First Name</label>

                                            <input id="firstnameinput" type="text" name="firstname" class="form-control" required value=''>

                                        </div>

                                    </div>

                                    <div class="col-12 col-md-4">

                                        <div class="form-group">

                                            <label>Last Name</label>

                                            <input id="lastnameinput" type="text" name="lastname" class="form-control" value=''>

                                        </div>

                                    </div>


  





                                </div>

                                <div class="submit-section">


                                    <div class="slider-button-wrp col-md-3"> <button type='submit' class="change-color-button btn btn-block">Save Changes</button> </div>

                                </div>

                            </form>

                            <!-- /Profile Settings Form -->



                        </div>

                    </div>

                </div>

            </div>



        </div>



    </div>

    <!-- /Page Content -->

</div>
  
<div class="change-avatar" style="display: flex; flex-direction: column; align-items: center;">

    <h5 id="img-name"></h5>

      <div class="upload-img" id="upload-img-container" >

          <div class="change-photo-btn button-color">

              <span><i class="fa fa-upload"></i> Upload Photo</span>

              <input id="upload-img" type="file" name='photo' class="upload" style="margin-top: 15px;">

          </div>

          <small style="margin-top: 15px;" class="form-text text-muted">Allowed JPG, GIF or PNG. Max

              size of 2MB</small>

              <button style="margin-top: 15px;" onclick="uploadImage()"  type="submit">Submit image</button>

      </div>

  </div>
<!-- Footer -->

<footer class="footer">

	<!--footer-->

<div class="footer-wraper">

  <div class="container">

    <div class="row">
      <div class="col-md-12 col-sm-12">
        <div class=" logo-site"> <img  width="416px" height="88px" alt="logo">
          <div class="text-center mt-2 float-right mt-4">
            <p class="social-icon-img">

              <span><a href="https://www.facebook.com/IMC-Hospital-101293648776603" target="_blank"> <img  width="36px" height="36px" alt="icon"> </a>
                <a href="https://twitter.com/IMCHospital_Pk" target="_blank"> <img  width="36px" height="36px" alt="icon"> </a>
                <a href="https://www.linkedin.com/company/integrated-medical-care-hospital/" target="_blank"> <img  width="36px" height="36px" alt="icon"> </a>
                <a href="https://www.instagram.com/imchospitaldha/" target="_blank"> <img " width="36px" height="36px" alt="icon"> </a>
                <a href="https://www.youtube.com/channel/UCRKz69iD9uTn-IqvJwa-X4A" target="_blank"> <img  width="36px" height="36px" alt="icon"> </a> </span>
            </p>


          </div>
        </div>
      </div>
    </div>



    <ul class="row footer-ul">



      <li class="col-md-4 col-sm-6 col-xs-12">

        <div class="listing-foote-wrp">

          <h3> About IMC Hospital </h3>

          <a href="https://www.imchospital.com.pk"> &gt;&gt; Home </a>

          <a href="https://www.imchospital.com.pk/about-us"> &gt;&gt; About Us </a>

          <!-- <a href="https://www.imchospital.com.pk/departments-services"> &gt;&gt; Services & Departments </a> -->

          <a href="https://www.imchospital.com.pk/our-doctors"> &gt;&gt; IMC Doctors </a>

          <a href="https://www.imchospital.com.pk/pharmacy"> &gt;&gt; Pharmacy </a>

          <a href="https://www.imchospital.com.pk/test-list"> &gt;&gt; Diagnostics </a>



          <a href="https://www.imchospital.com.pk/my-login"> &gt;&gt; My IMC </a>



        </div>

      </li>

      <li class="col-md-4 col-sm-6 col-xs-12">

        <div class="listing-foote-wrp">

          <h3> Actions </h3>

          <a href="https://www.imchospital.com.pk/my-appointments"> &gt;&gt; Appointments </a>

          <a href="https://www.imchospital.com.pk/phone-directory"> &gt;&gt; Phone Directory </a>


          <a href="https://www.imchospital.com.pk/contact-us"> &gt;&gt; Contact Us </a>
          <a href="https://www.imchospital.com.pk/news-and-events"> &gt;&gt; News &amp; Events </a>
          <a href="https://www.imchospital.com.pk/visitor-information"> &gt;&gt; Visitor Information </a>
          <a href="https://www.imchospital.com.pk/blogs"> &gt;&gt; Blogs </a>
          <a href="https://www.imchospital.com.pk/careers"> &gt;&gt; Careers </a>
        </div>



      </li>

      <li class="col-md-4 col-sm-6 col-xs-12">

        <div class="listing-foote-wrp">

          <h3> Site Information &amp; Policies </h3>


          <a href="https://www.imchospital.com.pk/site-map"> &gt;&gt; Site Map </a>

          <a href="https://www.imchospital.com.pk/about-this-website"> &gt;&gt; About This Website </a>

          <a href="https://www.imchospital.com.pk/copy-rights"> &gt;&gt; Copyright &amp; Licensing </a>

          <a href="https://www.imchospital.com.pk/privacy-policy"> &gt;&gt; Privacy Policy </a>
          <a href="https://www.imchospital.com.pk/corporate-partners"> &gt;&gt; Corporate Partners </a>
          <a href="https://www.imchospital.com.pk/complaints"> &gt;&gt; Complaints </a>
          <a href="https://www.imchospital.com.pk/documents"> &gt;&gt; Documents </a>
         
        </div>



      </li>


    </ul>

  </div>


<div style="display:none"><a href="http://ankararus.net" title="ankara escort">ankara escort</a> <a href="http://www.forumzevk.com/ad-category/cankaya-escort/" title="çankaya escort">çankaya escort</a> <a href="http://www.forumzevk.com" title="ankara escort">ankara escort</a></div>
  <!--coprights-->

  <div class="copy-right-wrp copyright-footer">Copyright&nbsp;<i class="fa fa-copyright" aria-hidden="true"></i> 2021 IMC Hospital. All rights reserved. <br> Powered by Contech International </div>


  <!--coprights-->



</div>

<!-- <script src="https://www.imchospital.com.pk/front/js/jquery-1.12.4.min.js"></script> -->

<!-- <script src="https://www.imchospital.com.pk/front/js/aos.js"></script> -->

<!-- <script src="https://www.imchospital.com.pk/front/js/wow.min.js"></script> -->

<!-- <script src="https://www.imchospital.com.pk/front/js/bootstrap.min.js"></script>
<script src="https://www.imchospital.com.pk/front/js/lazysizes.min.js"></script> -->
<!-- <script src="https://www.imchospital.com.pk/front/js/bootstrap.js"></script> -->


<!-- <script src="https://www.imchospital.com.pk/front/js/owl.carousel.min.js"></script> -->
<!-- <script>
  AOS.init({
    offset: 120,
    duration: 2000
  });
</script> -->




	<!-- /Footer Bottom -->



	<!-- /Footer -->
	<!-- <script src="https://www.imchospital.com.pk/patient/assets/js/jquery.min.js"></script> -->

	<!-- Bootstrap Core JS -->

	<!-- <script src="https://www.imchospital.com.pk/patient/assets/js/popper.min.js"></script>

	<script src="https://www.imchospital.com.pk/patient/assets/js/bootstrap.min.js"></script>

	<script src="https://www.imchospital.com.pk/patient/assets/plugins/theia-sticky-sidebar/ResizeSensor.js"></script>

	<script src="https://www.imchospital.com.pk/patient/assets/plugins/theia-sticky-sidebar/theia-sticky-sidebar.js"></script> -->

	<!-- Select2 JS -->

	<!-- <script src="https://www.imchospital.com.pk/patient/assets/plugins/select2/js/select2.min.js"></script> -->

	<!-- Fancybox JS -->

	<!-- <script src="https://www.imchospital.com.pk/patient/assets/plugins/fancybox/jquery.fancybox.min.js"></script> -->

	<!-- Dropzone JS -->
<!-- 
	<script src="https://www.imchospital.com.pk/patient/assets/plugins/dropzone/dropzone.min.js"></script> -->



	<!-- Bootstrap Tagsinput JS 

		<script src="https://www.imchospital.com.pk/patient/assets/plugins/bootstrap-tagsinput/js/bootstrap-tagsinput.js"></script> -->



	<!-- Profile Settings JS -->

	<!-- <script src="https://www.imchospital.com.pk/patient/assets/js/profile-settings.js"></script> -->

	<!-- Circle Progress JS -->
<!-- 
	<script src="https://www.imchospital.com.pk/patient/assets/js/circle-progress.min.js"></script> -->

	<!-- Slick JS -->

	<!-- <script src="https://www.imchospital.com.pk/patient/assets/js/slick.js"></script> -->



	<!-- Custom JS -->

	<!-- <script src="https://www.imchospital.com.pk/patient/assets/js/script.js"></script>
	<script src="https://www.imchospital.com.pk/dist/sweetalert2.all.min.js"></script> -->

</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/3.3.4/jquery.inputmask.bundle.min.js"></script>


<script>
    $(document).ready(function() {
      

        $('#phoneno').inputmask('03999999999');
        $('#cnic').inputmask('99999-9999999-9');

    });
</script>

<script>

document.getElementById("user-form").addEventListener("submit" , async function(){
        event.preventDefault();
            const formData = new FormData(event.target);
            const formDataObject = Object.fromEntries(formData.entries());
            console.log(formDataObject);

            const form = document.getElementById("user-form");
                const errText = document.createElement("h3");
                errText.classList.add("err-text");
                const successText =  document.createElement("h3");
                successText.classList.add("success-text");

            try {
           
                const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));

                if(!loggedInUser && !loggedInUser.token){
                    throw new Error("Token missing , you are not logged in!");
                }
            

                const response = await fetch(`https://sk-hospital.onrender.com/api/users/edit/${loggedInUser.userId}`, {
                    method: 'PATCH',
                    headers: {
                        'Content-Type': 'application/json' ,
                        'Authorization' : "Bearer " + loggedInUser.token
                    },
                    body: JSON.stringify({
                      email : formDataObject.email ,
                      phone_no : formDataObject.phone_no,
                      first_name : formDataObject.firstname,
                      last_name : formDataObject.lastname
                    })
                });

                const responseData = await response.json();

                if (response.status ===500 || response.status===400 || response.status===403) {
                    throw new Error(responseData.message);
                }

                errText.innerText = "";
                successText.innerText = responseData.message;
                form.appendChild(errText);
                form.appendChild(successText);

            } catch (error) {
                  
                  errText.innerText = error.message;
                  successText.innerText = "";
                  form.appendChild(errText);
                form.appendChild(successText);
            }
    });

    
        function logout(){
        localStorage.removeItem("loggedInUser");
        window.location.href = "/my-login.html";
    }

</script>

<script>
        window.onload = async function (){
        const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));

if(!loggedInUser  ){
  window.location.href = "/my-login.html";
}

console.log("onload is working!");

const fnInput =  document.getElementById("firstnameinput");
const lnInput = document.getElementById("lastnameinput");
const phoneInput =  document.getElementById("phonenoinput");
const emailInput = document.getElementById("emailinput");
const userImage = document.getElementById("user-img");
const userImage2 = document.getElementById("user-img2");
const profileInfoName = document.getElementById("profile-info-name");

const form = document.getElementById("user-form");
                const errText = document.createElement("h3");
                errText.classList.add("err-text");
                const successText =  document.createElement("h3");
                successText.classList.add("success-text");



try {
      const response = await fetch("https://sk-hospital.onrender.com/api/users/details/get" , {
        headers : {
            'Content-Type' : 'application/json' ,
            'Authorization' : 'Bearer ' + loggedInUser.token
        }
      });

      const responseData = await response.json();

      if(response.status===400 || response.status===500 || response.status===403){
        throw new Error(responseData.message);
      }

      console.log("fetched profile info : ");
      console.log(responseData);

      fnInput.value = responseData.first_name;
      lnInput.value = responseData.last_name;
      emailInput.value = responseData.email;
      phoneInput.value = responseData.phone_no;
      userImage.src = responseData.profile_pic;
      userImage2.src = responseData.profile_pic;
      profileInfoName.innerText = "Hello " + responseData.first_name + " " +  responseData.last_name;
         
      const userData = {
                    email : responseData.email ,
first_name :  responseData.first_name,
last_name : responseData.last_name,
phone_no :  responseData.phone_no ,
profile_pic : responseData.profile_pic,
token: loggedInUser.token,
userId : loggedInUser.userId
                };

                localStorage.setItem("loggedInUser" , JSON.stringify(userData));
} catch (error) {
       errText.innerText = error.message;
       form.appendChild(errText);
}


    }
</script>

<script>
    document.getElementById("upload-img").addEventListener("change" , function(event){
        const file = event.target.files[0];

        const imgName = document.getElementById("img-name");
        imgName.innerText = "Selected image : " + file.name;
         
    })
</script>

<script>
       async function uploadImage(){

            const image = document.getElementById("upload-img");
            const imageContainer = document.getElementById("upload-img-container");
            console.log("image to submit : ");
             
            const imageFile = image.files[0];

            const formData = new FormData();
            formData.append("image" , imageFile);

            const userImage = document.getElementById("user-img");
            const userImage2 = document.getElementById("user-img2");

    

            try {
                const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));
            if(!loggedInUser){
                 throw new Error("User is not logged in!");
            }    

            const response = await fetch("https://sk-hospital.onrender.com/api/users/upload/pfp" , {
                method : "POST" ,
                headers : {
                    "Authorization" : "Bearer " + loggedInUser.token
                },
                body : formData
            });

            const responseData = await response.json();

            if(response.status===400 || response.status===500 || response.status===403){
                throw new Error(responseData.message);
            }

            userImage.src = responseData.imageUrl;
            userImage2.src = responseData.imageUrl;

            console.log("image uploaded!");
            

            } catch (error) {
                      const errText = document.createElement("h5");
                      errText.innerHTML = error.message;
                      imageContainer.appendChild(errText);
            }

       }
</script>



</body>



<!-- Mirrored from doccure-laravel.dreamguystech.com/template/public/patient-dashboard by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 26 Jan 2021 05:56:09 GMT -->



</html>
